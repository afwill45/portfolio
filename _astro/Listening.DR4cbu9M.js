import{j as t}from"./jsx-runtime.B4ELNKBR.js";import{r as h}from"./index.B80Lgev0.js";/* empty css                      */const j=()=>(h.useEffect(()=>{(async()=>{const m=localStorage.getItem("listeningToCached"),a=localStorage.getItem("listeningToCacheTimestamp");if(m&&a){const s=new Date().getTime(),e=1*60*1e3;if(s-parseInt(a)>e)console.log("Refresh cache");else{const g=localStorage.getItem("listeningToImage"),d=localStorage.getItem("listeningToLink"),u=localStorage.getItem("listeningToTitle"),I=localStorage.getItem("listeningToArtist"),T=localStorage.getItem("listeningToListening");document.getElementById("currently-image").setAttribute("src",g),document.getElementById("track-link").setAttribute("href",d),document.getElementById("track-title").innerHTML=u,document.getElementById("track-artist").innerHTML="by "+I,document.getElementById("track-listening").innerHTML=T;return}}const n=(await(await fetch("https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=afroski10&api_key=620fcc08ae179fd933c512f69ecb472e&format=json&limit=1")).json()).recenttracks.track[0],r=n.artist["#text"],o=n.image[2]["#text"],{name:c,url:l}=n;let i;if(n["@attr"]!==void 0)i="ðŸŽµ Now Listening";else{const s=parseInt(n.date.uts),e=new Date(s*1e3);i=e.getHours()+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+", "+e.toDateString()}document.getElementById("currently-image").setAttribute("src",o),document.getElementById("track-link").setAttribute("href",l),document.getElementById("track-title").innerHTML=c,document.getElementById("track-artist").innerHTML="by "+r,document.getElementById("track-listening").innerHTML=i,localStorage.setItem("listeningToImage",o),localStorage.setItem("listeningToLink",l),localStorage.setItem("listeningToTitle",c),localStorage.setItem("listeningToArtist",r),localStorage.setItem("listeningToListening",i),localStorage.setItem("listeningToCacheTimestamp",new Date().getTime().toString()),localStorage.setItem("listeningToCached","true")})()},[]),t.jsxs("div",{children:[t.jsx("span",{className:"currently-header",children:"I'm listening to:"}),t.jsxs("div",{id:"currently-container",children:[t.jsx("a",{id:"track-link",href:"https://open.spotify.com/user/notyihui",target:"_blank",children:t.jsx("img",{id:"currently-image",src:"https://yihui-work.s3.us-east-2.amazonaws.com/placeholder-track-art.png",className:"sidebar_asset"})}),t.jsxs("div",{id:"currently-info",children:[t.jsx("span",{id:"track-title",children:"Loading..."}),t.jsx("span",{id:"track-artist"}),t.jsx("span",{id:"track-listening",style:{opacity:.4}})]})]})]}));export{j as default};
